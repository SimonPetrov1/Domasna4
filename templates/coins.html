{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mt-3 mb-3">
  <h3>Markets</h3>
</div>

<form class="row mb-3" method="get">
  <div class="col-md-2 mb-2">
    <input class="form-control" name="q" placeholder="Search coin" value="{{ query }}">
  </div>
  <div class="col-md-2 mb-2">
    <input class="form-control" name="min_price" placeholder="Min price" value="{{ min_price }}">
  </div>
  <div class="col-md-2 mb-2">
    <input class="form-control" name="max_price" placeholder="Max price" value="{{ max_price }}">
  </div>
  <div class="col-md-2 mb-2">
    <input class="form-control" name="min_vol" placeholder="Min volume" value="{{ min_vol }}">
  </div>
  <div class="col-md-2 mb-2">
    <select class="form-select" name="sort">
      <option value="price" {% if sort=='price' %}selected{% endif %}>Price</option>
      <option value="volume" {% if sort=='volume' %}selected{% endif %}>Volume</option>
    </select>
  </div>
  <div class="col-md-2 mb-2">
    <select class="form-select" name="dir">
      <option value="desc" {% if direction=='desc' %}selected{% endif %}>Desc</option>
      <option value="asc" {% if direction=='asc' %}selected{% endif %}>Asc</option>
    </select>
  </div>
  <div class="col-12 mb-2">
    <button class="btn btn-primary">Apply</button>
  </div>
</form>

<div class="market-table-card">
  <table class="table mb-0">
    <thead>
      <tr>
        <th>#</th>
        <th>Coin</th>
        <th>Price</th>
        <th>Market cap</th>
        <th>Volume</th>
        <th>24h Change</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for s in symbols %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ s }}</td>
        <td>{{ stats[s].price_fmt }}</td>
        <td>${{ stats[s].market_cap_fmt }}</td>
        <td>{{ stats[s].volume_fmt }}</td>
        <td class="{% if stats[s].change_24h >= 0 %}text-success{% else %}text-danger{% endif %}">
          {{ "%.2f"|format(stats[s].change_24h) }}%
        </td>
        <td><a href="/coin/{{ s }}" class="info-btn">Info</a></td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
